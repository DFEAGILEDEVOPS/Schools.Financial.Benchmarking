@section InsideHead{
    <!-- Add references to the Azure Maps Map control JavaScript and CSS files. -->
    <link rel="stylesheet" href="https://atlas.microsoft.com/sdk/css/atlas.min.css?api-version=1" type="text/css" />
    <script src="https://atlas.microsoft.com/sdk/js/atlas.min.js?api-version=1"></script>

    <!-- Add a reference to the Azure Maps Services Module JavaScript file. -->
    <script src="https://atlas.microsoft.com/sdk/js/atlas-service.js?api-version=1"></script>

    <script>


    </script>

    <style>


        #myMap {
            width: 500px;
            height: 400px;
            border-width: 1px;
            border-color: black;
            border-style: solid;
        }
    </style>
}

<p>
    <h3>Ark Academy, Forty Avenue, Wembley, HA9 9JR</h3>

    <div id="myMap"></div>
</p>

@section ViewScripts{
    <script>
        var map, datasource, client, popup;

        $(function () {
            //Add your Azure Maps subscription key to the map SDK. Get an Azure Maps key at https://azure.com/maps
            atlas.setSubscriptionKey('@System.Web.Configuration.WebConfigurationManager.AppSettings["AzureMapsAPIKey"]');

            //Initialize a map instance.
            var mapCenterPosition = [-0.280167460441589, 51.5655598764621];
            map = new atlas.Map('myMap', {
                center: mapCenterPosition,
                zoom: 15
            });

            //Wait until the map resources have fully loaded.
            map.events.add('load', function () {

                //Create a data source and add it to the map.
                datasource = new atlas.source.DataSource();
                map.sources.add(datasource);

                //Add a layer for rendering point data.
                var resultLayer = new atlas.layer.SymbolLayer(datasource, null, {
                    iconOptions: {
                        iconImage: 'pin-round-darkblue',
                        anchor: 'center',
                        allowOverlap: true
                    }
                });
                map.layers.add(resultLayer);

                //Create a popup but leave it closed so we can update it and display it later.
                //popup = new atlas.Popup();

                //Add a mouse over event to the result layer and display a popup when this event fires.
                //map.events.add('mouseover', resultLayer, showPopup);

                //Create an instance of the services client.
                client = new atlas.service.Client(atlas.getSubscriptionKey());
                
                //Add the results to the data source so they can be rendered.
                //datasource.add(results);
                var points = [new atlas.data.Point(mapCenterPosition)];
                datasource.add(points);

                // Set the camera bounds

                //map.setCamera({
                //    bounds: results.bbox,
                //    zoom: 13
                //});

                /* Construct a zoom control*/
                var zoomControl = new atlas.control.ZoomControl();

                /* Add the zoom control to the map*/
                map.controls.add(zoomControl, {
                    position: "top-left"
                });

                /* Construct and add a style control*/
                var styleControl = new atlas.control.StyleControl();
                map.controls.add(styleControl, {
                    position: "top-right"
                })

            });

        });

        //function showPopup(e) {
        //    //Get the properties and coordinates of the first shape that the event occured on.
        //    var p = e.shapes[0].getProperties();
        //    var position = e.shapes[0].getCoordinates();

        //    //Create HTML from properties of the selected result.
        //    var html = ['<div style="padding:5px"><div><b>', p.poi.name,
        //        '</b></div><div>', p.address.freeformAddress,
        //        '</div><div>', position[1], ', ', position[0], '</div></div>'];

        //    //Update the content and position of the popup.
        //    popup.setPopupOptions({
        //        content: html.join(''),
        //        position: position
        //    });

        //    //Open the popup.
        //    popup.open(map);
        //}

    </script>
}
